{"version":3,"file":"js/432.41dcf307.js","mappings":"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","sources":["webpack://my_cloud_javaweb_project/./src/class/config.js","webpack://my_cloud_javaweb_project/./src/views/shop/CartPage.vue","webpack://my_cloud_javaweb_project/./src/views/shop/CartPage.vue?88e5"],"sourcesContent":["const config = {\n    baseUrl: 'http://localhost:8081',\n    api: {\n        captcha: '/user/captcha',\n        login: '/user/login',\n        register: '/user/register',\n        logout: '/user/logout',\n        getUserInfo: '/user/getinfo',\n        authToken:'/user/token-auth',\n        ip: '/system/ip',\n        ShopInfo: \"/element/info\",\n        code: '/user/code',\n        selectUser:\"/user/select-info\",\n        deleteUser:\"/user/delete\",\n        updateUser:\"/user/change\",\n        deleteShop:\"/element/delete\",\n        uploadImg:\"/system/img/base64\",\n        updateShop:\"/element/change\",\n        insertShop:\"/element/insert\",\n        getOrders:\"/pay/getall\",\n        payInsert:\"/pay/top-up\",\n        payMyinfo:\"/pay/get\",\n        payEx:\"/pay/exchange\",\n        payForOrder:\"/pay/pay-order\"\n    },\n    apiUrl: '/api'\n}\nexport default config","<template>\n  <div>\n    <el-card class=\"box-card\" style=\"margin-top: 20px\">\n      <template #header>\n        <div class=\"card-header\">\n          <span>你的购物车</span>\n        </div>\n      </template>\n      <el-table :data=\"cart\" style=\"width: 100%\">\n        <el-table-column prop=\"name\" label=\"商品名称\" width=\"180\" />\n        <el-table-column prop=\"price\" label=\"单价\" width=\"180\" />\n        <el-table-column prop=\"quantity\" label=\"数量\" width=\"180\" />\n        <el-table-column prop=\"localtotal\" label=\"小计\" width=\"180\" />\n        <el-table-column label=\"操作\">\n          <template #default=\"scope\">\n            <el-button size=\"medium\" @click=\"removeFromCart(scope.row)\">删除</el-button>\n            <el-input-number style=\"margin-left: 20px\" v-model=\"scope.row.quantity\" :min=\"1\" :max=\"100\" label=\"数量\" @change=\"updateQuantity(scope.row)\" />\n          </template>\n        </el-table-column>\n      </el-table>\n      <div class=\"total\">\n        <strong>总价: ￥{{ total }}</strong>\n      </div>\n      <br>\n      <div style=\"display: flex;justify-content: right\">\n        <el-button type=\"primary\" style=\"min-width: 120px;\" @click=\"payForItem\">提交订单</el-button>\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport config from \"@/class/config\";\nexport default {\n  data() {\n    return {\n      cart: [],\n      total: 0\n    }\n  },\n  mounted() {\n    var token = this.$cookies.get(\"token\");\n    if(token==null&&token==\"\"){\n      this.$message.error(\"未检测到登录态,无法使用购物车功能。\");\n      this.$cookies.remove(\"token\");\n      this.$router.push(\"/user/login\");\n      return;\n    }\n  //   扫描所有cookie 除了token 与permission\n    this.$axios.get(config.baseUrl+config.apiUrl+config.api.ShopInfo,{}).then(res=>{\n      if(res.data.Code===200){\n        for (var i=0;i<res.data.elements.length;i++){\n          if(this.$cookies.get(res.data.elements[i].name)!=null){\n            this.cart.push({ name: res.data.elements[i].name, price: res.data.elements[i].price, quantity: this.$cookies.get(res.data.elements[i].name), localtotal: res.data.elements[i].price*this.$cookies.get(res.data.elements[i].name),maxValue: res.data.elements[i].value });\n            this.total += parseFloat(res.data.elements[i].price*this.$cookies.get(res.data.elements[i].name));\n          }\n        }\n      }else{\n        this.$message.error(res.data.Response);\n      }\n    })\n\n  },\n  methods: {\n    payForItem(){\n      this.$router.push(\"/order\");\n    },\n    removeFromCart(item) {\n      var token = this.$cookies.get(\"token\");\n      if(token==null&&token==\"\"){\n        this.$message.error(\"未检测到登录态,无法使用购物车功能。\");\n        this.$cookies.remove(\"token\");\n        this.$router.push(\"/user/login\");\n        return;\n      }\n      this.$cookies.remove(item.name);\n    //   刷新页面\n      this.$router.go(0);\n    },\n    updateQuantity(item) {\n      var token = this.$cookies.get(\"token\");\n      if(token==null&&token==\"\"){\n        this.$message.error(\"未检测到登录态,无法使用购物车功能。\");\n        this.$cookies.remove(\"token\");\n        this.$router.push(\"/user/login\");\n        return;\n      }\n      if(item.quantity>item.maxValue){\n        this.$message.error(\"商品库存不足,无法继续添加。\");\n        item.quantity = item.maxValue;\n        return;\n      }\n    //   直接修改cookie\n      this.$cookies.set(item.name,item.quantity,{path:\"/\",expires:30});\n    //   更新数据\n      var total = 0;\n      for (var i=0;i<this.cart.length;i++){\n        if(this.cart[i].name===item.name){\n          this.cart[i].quantity = item.quantity;\n          this.cart[i].localtotal = item.quantity*item.price;\n        }\n        total += parseFloat(this.cart[i].localtotal);\n      }\n      this.total = total;\n    }\n  }\n}\n\n</script>\n\n<style scoped>\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.total {\n  text-align: right;\n  margin-top: 10px;\n  font-size: 18px;\n}\n</style>\n","import { render } from \"./CartPage.vue?vue&type=template&id=68bb08e6&scoped=true\"\nimport script from \"./CartPage.vue?vue&type=script&lang=js\"\nexport * from \"./CartPage.vue?vue&type=script&lang=js\"\n\nimport \"./CartPage.vue?vue&type=style&index=0&id=68bb08e6&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-68bb08e6\"]])\n\nexport default __exports__"],"names":["config","baseUrl","api","captcha","login","register","logout","getUserInfo","authToken","ip","ShopInfo","code","selectUser","deleteUser","updateUser","deleteShop","uploadImg","updateShop","insertShop","getOrders","payInsert","payMyinfo","payEx","payForOrder","apiUrl","class","style","_createElementBlock","_createVNode","_component_el_card","header","_withCtx","_cache","_createElementVNode","default","_component_el_table","data","$data","cart","_component_el_table_column","prop","label","width","scope","_component_el_button","size","onClick","$event","$options","removeFromCart","row","_createTextVNode","_","_component_el_input_number","modelValue","quantity","min","max","onChange","updateQuantity","_hoisted_1","_toDisplayString","total","_hoisted_2","type","payForItem","mounted","token","this","$cookies","get","$message","error","remove","$router","push","$axios","then","res","Code","i","elements","length","name","price","localtotal","maxValue","value","parseFloat","Response","methods","item","go","set","path","expires","__exports__","render"],"sourceRoot":""}