{"version":3,"file":"js/280.521b6c37.js","mappings":"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","sources":["webpack://my_cloud_javaweb_project/./src/class/config.js","webpack://my_cloud_javaweb_project/./src/views/shop/OrderPage.vue","webpack://my_cloud_javaweb_project/./src/views/shop/OrderPage.vue?af25"],"sourcesContent":["const config = {\n    baseUrl: 'http://localhost:8081',\n    api: {\n        captcha: '/user/captcha',\n        login: '/user/login',\n        register: '/user/register',\n        logout: '/user/logout',\n        getUserInfo: '/user/getinfo',\n        authToken:'/user/token-auth',\n        ip: '/system/ip',\n        ShopInfo: \"/element/info\",\n        code: '/user/code',\n        selectUser:\"/user/select-info\",\n        deleteUser:\"/user/delete\",\n        updateUser:\"/user/change\",\n        deleteShop:\"/element/delete\",\n        uploadImg:\"/system/img/base64\",\n        updateShop:\"/element/change\",\n        insertShop:\"/element/insert\",\n        getOrders:\"/pay/getall\",\n        payInsert:\"/pay/top-up\",\n        payMyinfo:\"/pay/get\",\n        payEx:\"/pay/exchange\",\n        payForOrder:\"/pay/pay-order\"\n    },\n    apiUrl: '/api'\n}\nexport default config","<template>\n  <div>\n    <el-card class=\"box-card\" style=\"margin-top: 20px\">\n      <template #header>\n        <div class=\"card-header\">\n          <span>你的订单</span>\n        </div>\n      </template>\n      <el-table :data=\"cart\" style=\"width: 100%\">\n        <el-table-column prop=\"name\" label=\"商品名称\" width=\"180\" />\n        <el-table-column prop=\"price\" label=\"单价\" width=\"180\" />\n        <el-table-column prop=\"quantity\" label=\"数量\" width=\"180\" />\n        <el-table-column prop=\"localtotal\" label=\"小计\" width=\"180\" />\n      </el-table>\n      <div class=\"total\">\n        <strong>总价: ￥{{ total }}</strong>\n      </div>\n      <br>\n      <div style=\"display: flex;justify-content: right\">\n        <el-button type=\"primary\" style=\"min-width: 120px;\" @click=\"processPayment\">进行支付</el-button>\n      </div>\n    </el-card>\n  </div>\n</template>\n\n<script>\nimport config from \"@/class/config\";\n\nexport default {\n  data() {\n    return {\n      cart: [],\n      total: 0\n    }\n  },\n  mounted() {\n    var token = this.$cookies.get(\"token\");\n    if(token==null||token==\"\"){\n      this.$message.error(\"未检测到登录态,无法使用功能。\");\n      this.$cookies.remove(\"token\");\n      this.$router.push(\"/user/login\");\n      return;\n    }\n  //   验证token有效性\n    this.$axios.post(config.baseUrl+config.apiUrl+config.api.authToken,{},{headers:{\n      'token':token\n      }}).then(res=>{\n        if(res.data.Code===200){\n        //   注册token并更新\n          this.$cookies.set(\"token\",token,{expires:30,path:\"/\"});\n        }else{\n          this.$message.error(res.data.Response);\n          this.$cookies.remove(\"token\");\n          this.$router.push(\"/user/login\");\n          return;\n        }\n    })\n  //   扫描所有cookie 除了token 与permission\n    this.$axios.get(config.baseUrl+config.apiUrl+config.api.ShopInfo,{}).then(res=>{\n      if(res.data.Code===200){\n        for (var i=0;i<res.data.elements.length;i++){\n          if(this.$cookies.get(res.data.elements[i].name)!=null){\n            this.cart.push({ name: res.data.elements[i].name, price: res.data.elements[i].price, quantity: this.$cookies.get(res.data.elements[i].name), localtotal: res.data.elements[i].price*this.$cookies.get(res.data.elements[i].name),maxValue: res.data.elements[i].value });\n            this.total += parseFloat(res.data.elements[i].price*this.$cookies.get(res.data.elements[i].name));\n          }\n        }\n      }else{\n        this.$message.error(res.data.Response);\n      }\n    })\n  },\n  methods:{\n    processPayment(){\n      var token = this.$cookies.get(\"token\");\n      if(token==null||token==\"\"){\n        this.$message.error(\"未检测到登录态,无法进行支付。\");\n        this.$cookies.remove(\"token\");\n        this.$router.push(\"/user/login\");\n        return;\n      }\n      this.$axios.post(config.baseUrl+config.apiUrl+config.api.payForOrder,{\n        \"items\":this.cart\n      },{\n        headers:{\n          'Token':token\n        }\n      }).then(res=>{\n        if(res.data.Code===200){\n          this.$message.success(res.data.Response);\n          // 将购物车cookie清零\n          for (var i=0;i<this.cart.length;i++){\n            this.$cookies.remove(this.cart[i].name);\n          }\n          this.$router.push(\"/payment\");\n        }else{\n          this.$message.error(res.data.Response);\n        }\n      })\n    }\n  }\n}\n\n</script>\n\n<style scoped>\n.card-header {\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n}\n\n.total {\n  text-align: right;\n  margin-top: 10px;\n  font-size: 18px;\n}\n</style>\n","import { render } from \"./OrderPage.vue?vue&type=template&id=4780d3d7&scoped=true\"\nimport script from \"./OrderPage.vue?vue&type=script&lang=js\"\nexport * from \"./OrderPage.vue?vue&type=script&lang=js\"\n\nimport \"./OrderPage.vue?vue&type=style&index=0&id=4780d3d7&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-4780d3d7\"]])\n\nexport default __exports__"],"names":["config","baseUrl","api","captcha","login","register","logout","getUserInfo","authToken","ip","ShopInfo","code","selectUser","deleteUser","updateUser","deleteShop","uploadImg","updateShop","insertShop","getOrders","payInsert","payMyinfo","payEx","payForOrder","apiUrl","class","style","_createElementBlock","_createVNode","_component_el_card","header","_withCtx","_cache","_createElementVNode","default","_component_el_table","data","$data","cart","_component_el_table_column","prop","label","width","_","_hoisted_1","_toDisplayString","total","_hoisted_2","_component_el_button","type","onClick","$options","processPayment","_createTextVNode","mounted","token","this","$cookies","get","$message","error","remove","$router","push","$axios","post","headers","then","res","Code","Response","set","expires","path","i","elements","length","name","price","quantity","localtotal","maxValue","value","parseFloat","methods","success","__exports__","render"],"sourceRoot":""}