"use strict";(self["webpackChunkmy_cloud_javaweb_project"]=self["webpackChunkmy_cloud_javaweb_project"]||[]).push([[10],{1764:function(e,t){const s={baseUrl:"http://localhost:8081",api:{captcha:"/user/captcha",login:"/user/login",register:"/user/register",logout:"/user/logout",getUserInfo:"/user/getinfo",authToken:"/user/token-auth",ip:"/system/ip",ShopInfo:"/element/info",code:"/user/code",selectUser:"/user/select-info",deleteUser:"/user/delete",updateUser:"/user/change",deleteShop:"/element/delete",uploadImg:"/system/img/base64",updateShop:"/element/change",insertShop:"/element/insert",getOrders:"/pay/getall",payInsert:"/pay/top-up",payMyinfo:"/pay/get",payEx:"/pay/exchange",payForOrder:"/pay/pay-order"},apiUrl:"/api"};t.A=s},2010:function(e,t,s){s.r(t),s.d(t,{default:function(){return u}});var a=s(6768),o=s(4232);const r={class:"payment-dashboard"},n={class:"card-content"},i={class:"card-content based-card"};function l(e,t,s,l,h,c){const p=(0,a.g2)("el-button"),d=(0,a.g2)("el-card"),u=(0,a.g2)("el-col"),g=(0,a.g2)("el-table-column"),k=(0,a.g2)("el-table"),m=(0,a.g2)("el-row");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(m,{gutter:20},{default:(0,a.k6)((()=>[(0,a.bF)(u,{span:12},{default:(0,a.k6)((()=>[(0,a.bF)(d,{shadow:"hover",class:"balance-card"},{default:(0,a.k6)((()=>[t[2]||(t[2]=(0,a.Lk)("div",{class:"card-header"},[(0,a.Lk)("span",null,"账户余额")],-1)),(0,a.Lk)("div",n,[(0,a.Lk)("h1",null,"¥ "+(0,o.v_)(h.mount),1),(0,a.bF)(p,{type:"primary",onClick:c.handleRecharge},{default:(0,a.k6)((()=>t[0]||(t[0]=[(0,a.eW)("充值")]))),_:1},8,["onClick"]),(0,a.bF)(p,{type:"success",onClick:c.handleTransfer},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)("转账")]))),_:1},8,["onClick"])])])),_:1})])),_:1}),(0,a.bF)(u,{span:12},{default:(0,a.k6)((()=>[(0,a.bF)(d,{shadow:"hover",class:"transaction-card"},{header:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.Lk)("div",{class:"card-header"},[(0,a.Lk)("span",null,"最近交易记录")],-1)]))),default:(0,a.k6)((()=>[(0,a.Lk)("div",i,[(0,a.bF)(k,{data:h.transactions,style:{width:"100%"}},{default:(0,a.k6)((()=>[(0,a.bF)(g,{prop:"orderId",label:"订单哈希",width:"290"}),(0,a.bF)(g,{prop:"time",label:"日期",width:"200"}),(0,a.bF)(g,{prop:"value",label:"交易发生额",width:"140"}),(0,a.bF)(g,{prop:"other",label:"备注",width:"150"})])),_:1},8,["data"])])])),_:1})])),_:1})])),_:1})])}s(4114);var h=s(1764),c={data(){return{mount:"1000.00",transactions:[]}},methods:{handleRecharge(){var e=this.$cookies.get("token");this.$prompt("请输入充值金额","充值",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[0-9]*\.?[0-9]+$/,inputErrorMessage:"请输入正确的金额"}).then((({value:t})=>{this.$axios.post(h.A.baseUrl+h.A.apiUrl+h.A.api.payInsert+"?value="+t,{},{headers:{token:e}}).then((e=>{200===e.data.Code?(this.$message.success(e.data.Response),this.$router.go(0)):this.$message.error(e.data.Response)}))})).catch((()=>{this.$message({type:"info",message:"用户取消充值"})}))},handleTransfer(){const e=this.$cookies.get("token");this.$prompt("请输入转账金额","转账",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/^[0-9]*\.?[0-9]+$/,inputErrorMessage:"请输入正确的金额"}).then((({value:t})=>{this.$prompt("请输入收款方账号","转账",{confirmButtonText:"确定",cancelButtonText:"取消",inputPattern:/.+/,inputErrorMessage:"请输入正确的账号"}).then((({value:s})=>{this.transfer(t,s,e)})).catch((()=>{this.showCancelMessage()}))})).catch((()=>{this.showCancelMessage()}))},transfer(e,t,s){this.$axios.post(h.A.baseUrl+h.A.apiUrl+h.A.api.payEx,{},{params:{value:e,towho:t},headers:{token:s}}).then((e=>{200===e.data.Code?(this.$message.success(e.data.Response),this.$router.go(0)):this.$message.error(e.data.Response)})).catch((()=>{this.$message({type:"info",message:"用户取消转账"})}))},showCancelMessage(){this.$message({type:"info",message:"用户取消转账"})}},mounted(){var e=this.$cookies.get("token");if(null==e||""===e)return this.$message.error("未检测到登录态"),this.$cookies.remove("token"),void this.$router.push("/user/login");this.$axios.post(h.A.baseUrl+h.A.apiUrl+h.A.api.authToken,{},{headers:{token:e}}).then((t=>{if(200!=t.data.Code)return this.$message.error(t.data.Response),this.$cookies.remove("token"),void this.$router.push("/user/login");this.$cookies.set("token",e,{expires:30,path:"/"}),this.$cookies.set("permission",t.data.permission,{path:"/"})})),this.$axios.post(h.A.baseUrl+h.A.apiUrl+h.A.api.getOrders,{},{headers:{token:e}}).then((e=>{if(200==e.data.Code){this.transactions=e.data.Orders;for(var t=0;t<this.transactions.length;t++)this.transactions[t].value>=0?this.transactions[t].value="￥+"+this.transactions[t].value.toFixed(2):this.transactions[t].value="￥"+this.transactions[t].value.toFixed(2)}else this.$message.error(e.data.Response)})),this.$axios.post(h.A.baseUrl+h.A.apiUrl+h.A.api.payMyinfo,{},{headers:{token:e}}).then((e=>{200===e.data.Code?this.mount=e.data.Value.toFixed(2):this.$message.error(e.data.Response)}))}},p=s(1241);const d=(0,p.A)(c,[["render",l],["__scopeId","data-v-4f019e84"]]);var u=d}}]);
//# sourceMappingURL=10.5f3182fe.js.map