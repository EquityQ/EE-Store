"use strict";(self["webpackChunkmy_cloud_javaweb_project"]=self["webpackChunkmy_cloud_javaweb_project"]||[]).push([[432],{1764:function(e,t){const a={baseUrl:"http://localhost:8081",api:{captcha:"/captcha",login:"/user/login",register:"/user/register",logout:"/user/logout",getUserInfo:"/user/getinfo",authToken:"/user/token-auth",ip:"/ip",ShopInfo:"/element/info",code:"/user/code",selectUser:"/user/select-info",deleteUser:"/user/delete",updateUser:"/user/change",deleteShop:"/element/delete",uploadImg:"/img/base64",updateShop:"/element/change",insertShop:"/element/insert",getOrders:"/order/getall",payInsert:"/pay/top-up",payMyinfo:"/pay/get",payEx:"/pay/exchange",payForOrder:"/pay/pay-order"},apiUrl:"/api"};t.A=a},432:function(e,t,a){a.r(t),a.d(t,{default:function(){return c}});var o=a(6768),r=a(4232);const l={class:"total"},s={style:{display:"flex","justify-content":"right"}};function i(e,t,a,i,n,u){const p=(0,o.g2)("el-table-column"),d=(0,o.g2)("el-button"),c=(0,o.g2)("el-input-number"),h=(0,o.g2)("el-table"),m=(0,o.g2)("el-card");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.bF)(m,{class:"box-card",style:{"margin-top":"20px"}},{header:(0,o.k6)((()=>t[0]||(t[0]=[(0,o.Lk)("div",{class:"card-header"},[(0,o.Lk)("span",null,"你的购物车")],-1)]))),default:(0,o.k6)((()=>[(0,o.bF)(h,{data:n.cart,style:{width:"100%"}},{default:(0,o.k6)((()=>[(0,o.bF)(p,{prop:"name",label:"商品名称",width:"180"}),(0,o.bF)(p,{prop:"price",label:"单价",width:"180"}),(0,o.bF)(p,{prop:"quantity",label:"数量",width:"180"}),(0,o.bF)(p,{prop:"localtotal",label:"小计",width:"180"}),(0,o.bF)(p,{label:"操作"},{default:(0,o.k6)((e=>[(0,o.bF)(d,{size:"medium",onClick:t=>u.removeFromCart(e.row)},{default:(0,o.k6)((()=>t[1]||(t[1]=[(0,o.eW)("删除")]))),_:2},1032,["onClick"]),(0,o.bF)(c,{style:{"margin-left":"20px"},modelValue:e.row.quantity,"onUpdate:modelValue":t=>e.row.quantity=t,min:1,max:100,label:"数量",onChange:t=>u.updateQuantity(e.row)},null,8,["modelValue","onUpdate:modelValue","onChange"])])),_:1})])),_:1},8,["data"]),(0,o.Lk)("div",l,[(0,o.Lk)("strong",null,"总价: ￥"+(0,r.v_)(n.total),1)]),t[3]||(t[3]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("div",s,[(0,o.bF)(d,{type:"primary",style:{"min-width":"120px"},onClick:u.payForItem},{default:(0,o.k6)((()=>t[2]||(t[2]=[(0,o.eW)("提交订单")]))),_:1},8,["onClick"])])])),_:1})])}a(4114);var n=a(1764),u={data(){return{cart:[],total:0}},mounted(){var e=this.$cookies.get("token");if(null==e&&""==e)return this.$message.error("未检测到登录态,无法使用购物车功能。"),this.$cookies.remove("token"),void this.$router.push("/user/login");this.$axios.get(n.A.baseUrl+n.A.apiUrl+n.A.api.ShopInfo,{}).then((e=>{if(200===e.data.Code)for(var t=0;t<e.data.elements.length;t++)null!=this.$cookies.get(e.data.elements[t].name)&&(this.cart.push({name:e.data.elements[t].name,price:e.data.elements[t].price,quantity:this.$cookies.get(e.data.elements[t].name),localtotal:e.data.elements[t].price*this.$cookies.get(e.data.elements[t].name),maxValue:e.data.elements[t].value}),this.total+=parseFloat(e.data.elements[t].price*this.$cookies.get(e.data.elements[t].name)));else this.$message.error(e.data.Response)}))},methods:{payForItem(){this.$router.push("/order")},removeFromCart(e){var t=this.$cookies.get("token");if(null==t&&""==t)return this.$message.error("未检测到登录态,无法使用购物车功能。"),this.$cookies.remove("token"),void this.$router.push("/user/login");this.$cookies.remove(e.name),this.$router.go(0)},updateQuantity(e){var t=this.$cookies.get("token");if(null==t&&""==t)return this.$message.error("未检测到登录态,无法使用购物车功能。"),this.$cookies.remove("token"),void this.$router.push("/user/login");if(e.quantity>e.maxValue)return this.$message.error("商品库存不足,无法继续添加。"),void(e.quantity=e.maxValue);this.$cookies.set(e.name,e.quantity,{path:"/",expires:30});for(var a=0,o=0;o<this.cart.length;o++)this.cart[o].name===e.name&&(this.cart[o].quantity=e.quantity,this.cart[o].localtotal=e.quantity*e.price),a+=parseFloat(this.cart[o].localtotal);this.total=a}}},p=a(1241);const d=(0,p.A)(u,[["render",i],["__scopeId","data-v-68bb08e6"]]);var c=d}}]);
//# sourceMappingURL=432.d55d73c0.js.map