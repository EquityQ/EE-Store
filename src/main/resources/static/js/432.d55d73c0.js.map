{"version":3,"file":"js/432.d55d73c0.js","mappings":"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","sources":["webpack://my_cloud_javaweb_project/./src/class/config.js","webpack://my_cloud_javaweb_project/./src/views/shop/CartPage.vue","webpack://my_cloud_javaweb_project/./src/views/shop/CartPage.vue?88e5"],"sourcesContent":["const config = {\r\n    baseUrl: 'http://localhost:8081',\r\n    api: {\r\n        captcha: '/captcha',\r\n        login: '/user/login',\r\n        register: '/user/register',\r\n        logout: '/user/logout',\r\n        getUserInfo: '/user/getinfo',\r\n        authToken:'/user/token-auth',\r\n        ip: '/ip',\r\n        ShopInfo: \"/element/info\",\r\n        code: '/user/code',\r\n        selectUser:\"/user/select-info\",\r\n        deleteUser:\"/user/delete\",\r\n        updateUser:\"/user/change\",\r\n        deleteShop:\"/element/delete\",\r\n        uploadImg:\"/img/base64\",\r\n        updateShop:\"/element/change\",\r\n        insertShop:\"/element/insert\",\r\n        getOrders:\"/order/getall\",\r\n        payInsert:\"/pay/top-up\",\r\n        payMyinfo:\"/pay/get\",\r\n        payEx:\"/pay/exchange\",\r\n        payForOrder:\"/pay/pay-order\"\r\n    },\r\n    apiUrl: '/api'\r\n}\r\nexport default config","<template>\r\n  <div>\r\n    <el-card class=\"box-card\" style=\"margin-top: 20px\">\r\n      <template #header>\r\n        <div class=\"card-header\">\r\n          <span>你的购物车</span>\r\n        </div>\r\n      </template>\r\n      <el-table :data=\"cart\" style=\"width: 100%\">\r\n        <el-table-column prop=\"name\" label=\"商品名称\" width=\"180\" />\r\n        <el-table-column prop=\"price\" label=\"单价\" width=\"180\" />\r\n        <el-table-column prop=\"quantity\" label=\"数量\" width=\"180\" />\r\n        <el-table-column prop=\"localtotal\" label=\"小计\" width=\"180\" />\r\n        <el-table-column label=\"操作\">\r\n          <template #default=\"scope\">\r\n            <el-button size=\"medium\" @click=\"removeFromCart(scope.row)\">删除</el-button>\r\n            <el-input-number style=\"margin-left: 20px\" v-model=\"scope.row.quantity\" :min=\"1\" :max=\"100\" label=\"数量\" @change=\"updateQuantity(scope.row)\" />\r\n          </template>\r\n        </el-table-column>\r\n      </el-table>\r\n      <div class=\"total\">\r\n        <strong>总价: ￥{{ total }}</strong>\r\n      </div>\r\n      <br>\r\n      <div style=\"display: flex;justify-content: right\">\r\n        <el-button type=\"primary\" style=\"min-width: 120px;\" @click=\"payForItem\">提交订单</el-button>\r\n      </div>\r\n    </el-card>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport config from \"@/class/config\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      cart: [],\r\n      total: 0\r\n    }\r\n  },\r\n  mounted() {\r\n    var token = this.$cookies.get(\"token\");\r\n    if(token==null&&token==\"\"){\r\n      this.$message.error(\"未检测到登录态,无法使用购物车功能。\");\r\n      this.$cookies.remove(\"token\");\r\n      this.$router.push(\"/user/login\");\r\n      return;\r\n    }\r\n  //   扫描所有cookie 除了token 与permission\r\n    this.$axios.get(config.baseUrl+config.apiUrl+config.api.ShopInfo,{}).then(res=>{\r\n      if(res.data.Code===200){\r\n        for (var i=0;i<res.data.elements.length;i++){\r\n          if(this.$cookies.get(res.data.elements[i].name)!=null){\r\n            this.cart.push({ name: res.data.elements[i].name, price: res.data.elements[i].price, quantity: this.$cookies.get(res.data.elements[i].name), localtotal: res.data.elements[i].price*this.$cookies.get(res.data.elements[i].name),maxValue: res.data.elements[i].value });\r\n            this.total += parseFloat(res.data.elements[i].price*this.$cookies.get(res.data.elements[i].name));\r\n          }\r\n        }\r\n      }else{\r\n        this.$message.error(res.data.Response);\r\n      }\r\n    })\r\n\r\n  },\r\n  methods: {\r\n    payForItem(){\r\n      this.$router.push(\"/order\");\r\n    },\r\n    removeFromCart(item) {\r\n      var token = this.$cookies.get(\"token\");\r\n      if(token==null&&token==\"\"){\r\n        this.$message.error(\"未检测到登录态,无法使用购物车功能。\");\r\n        this.$cookies.remove(\"token\");\r\n        this.$router.push(\"/user/login\");\r\n        return;\r\n      }\r\n      this.$cookies.remove(item.name);\r\n    //   刷新页面\r\n      this.$router.go(0);\r\n    },\r\n    updateQuantity(item) {\r\n      var token = this.$cookies.get(\"token\");\r\n      if(token==null&&token==\"\"){\r\n        this.$message.error(\"未检测到登录态,无法使用购物车功能。\");\r\n        this.$cookies.remove(\"token\");\r\n        this.$router.push(\"/user/login\");\r\n        return;\r\n      }\r\n      if(item.quantity>item.maxValue){\r\n        this.$message.error(\"商品库存不足,无法继续添加。\");\r\n        item.quantity = item.maxValue;\r\n        return;\r\n      }\r\n    //   直接修改cookie\r\n      this.$cookies.set(item.name,item.quantity,{path:\"/\",expires:30});\r\n    //   更新数据\r\n      var total = 0;\r\n      for (var i=0;i<this.cart.length;i++){\r\n        if(this.cart[i].name===item.name){\r\n          this.cart[i].quantity = item.quantity;\r\n          this.cart[i].localtotal = item.quantity*item.price;\r\n        }\r\n        total += parseFloat(this.cart[i].localtotal);\r\n      }\r\n      this.total = total;\r\n    }\r\n  }\r\n}\r\n\r\n</script>\r\n\r\n<style scoped>\r\n.card-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n}\r\n\r\n.total {\r\n  text-align: right;\r\n  margin-top: 10px;\r\n  font-size: 18px;\r\n}\r\n</style>\r\n","import { render } from \"./CartPage.vue?vue&type=template&id=68bb08e6&scoped=true\"\nimport script from \"./CartPage.vue?vue&type=script&lang=js\"\nexport * from \"./CartPage.vue?vue&type=script&lang=js\"\n\nimport \"./CartPage.vue?vue&type=style&index=0&id=68bb08e6&scoped=true&lang=css\"\n\nimport exportComponent from \"../../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-68bb08e6\"]])\n\nexport default __exports__"],"names":["config","baseUrl","api","captcha","login","register","logout","getUserInfo","authToken","ip","ShopInfo","code","selectUser","deleteUser","updateUser","deleteShop","uploadImg","updateShop","insertShop","getOrders","payInsert","payMyinfo","payEx","payForOrder","apiUrl","class","style","_createElementBlock","_createVNode","_component_el_card","header","_withCtx","_cache","_createElementVNode","default","_component_el_table","data","$data","cart","_component_el_table_column","prop","label","width","scope","_component_el_button","size","onClick","$event","$options","removeFromCart","row","_createTextVNode","_","_component_el_input_number","modelValue","quantity","min","max","onChange","updateQuantity","_hoisted_1","_toDisplayString","total","_hoisted_2","type","payForItem","mounted","token","this","$cookies","get","$message","error","remove","$router","push","$axios","then","res","Code","i","elements","length","name","price","localtotal","maxValue","value","parseFloat","Response","methods","item","go","set","path","expires","__exports__","render"],"sourceRoot":""}